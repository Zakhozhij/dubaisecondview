"use strict";function _slicedToArray(e,a){return _arrayWithHoles(e)||_iterableToArrayLimit(e,a)||_unsupportedIterableToArray(e,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,a){if(e){if("string"==typeof e)return _arrayLikeToArray(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,a):void 0}}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=new Array(a);t<a;t++)r[t]=e[t];return r}function _iterableToArrayLimit(e,a){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],n=!0,d=!1;try{for(t=t.call(e);!(n=(r=t.next()).done)&&(o.push(r.value),!a||o.length!==a);n=!0);}catch(e){d=!0,i=e}finally{try{n||null==t.return||t.return()}finally{if(d)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var leadId;function generatingRequestCrmPerson(e){var a=e.name,t=JSON.stringify({name:a,owner_id:leadDefinition(a).id,org_id:null,email:[{value:e.email}],phone:[{value:e.phone}]});addPersonCRM(t)}function generatingRequestCrm(e,a){var t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0,n=[],d=e.name;return void 0!==o&&o.map((function(e){var a=_slicedToArray(e.split("-"),3),t=a[0],r=a[1],i=a[2],o="".concat(i,"-").concat(t,"-").concat(r);n.push(o)})),reqForm=JSON.stringify({title:d+" (website)",owner_id:leadDefinition(d).id,"15cf2d212b53bbe08904b6454d0dda11d2955183":void 0!==e.from?e.from:e.fromTest,ed51689ac8d57fde6c8259726d65d78130fd22cf:void 0!==e.to?e.to:e.toTest,"975a4ff98eaadac198b6c3f5ece7966ccdd2ea0c":r[0],"1c985fab6c8d72c5a49a89d53c25fea361186950":i[0],"3987d4c219b326f88286096a10b36eabe1759de2":r[1],bb38a5969dcd07168ce004447d5314def1f9a27d:i[1],"3a708aefb21fce5a4b501c13650355485bc8ccdb":r[2],"5fb05fbb36a9c2a9b90889eb31f9cea7c5b70c70":i[2],e3afa5d082288104b0c11463c988c30094cda1f5:e.date_start,"8d25bea94361caaa064335f0b3100d612efeeb61":n[0],ebc6f8c082eb244de4dbbf09594abd183786b28e:n[1],ba7d9080f2a404d3f4b81fabe35de4ed94784867:n[2],fb1190db67d076973fe27eaa06537d8a75ed6366:leadDefinition(d).name,"409517a78292ede97512f0b6aca35115df587897":null!==(t=e.date_end)&&void 0!==t?t:"","4bd321ba92c84eab3dceda35bee2225409220c32":a,"7fa98115a09dc377c681fe93fd2b46cf40392220":e.adults,c623bc32d442aa2660609ba15092a1bab9d08ea8:e.children,eabbe7480419c088467df220fbc8a09032cf55ea:e.infants,"31559b4d1b62a55c3cd3d31fdd4749946019ebbd":e.phone,"957b07223a08444eea7d2b54052850d3d3d81522":e.email,"4bb2da9192ebd999d3fa40d96158960a10225267":e.name,db670b24252ed34785793ed4818c5a1ee7f99392:e.promoCode})}function requestCrmPersonData(e){var a=e.find((function(e){return"name"===e.name})),t=e.find((function(e){return"phone"===e.name})),r=e.find((function(e){return"email"===e.name})),i=e.find((function(e){return"email_active"===e.name})),o=JSON.stringify({name:void 0===a?"":a.value,owner_id:leadDefinition(a.value).id,org_id:null,email:[{value:void 0===r?void 0===i?"":i.value:r.value}],phone:[{value:void 0===t?"":t.value}]});addPersonCRM(o)}$.validator.addMethod("regex",(function(e,a,t){return this.optional(a)||t.test(e)}),"Please check your input."),$("form.form-valid").each((function(){$(this).validate({ignore:":hidden:not(:checkbox)",errorPlacement:function(e,a){a.is(":checkbox")?a.closest("label").append(e):e.insertAfter(a)},rules:{name:{required:!0},phone:{required:!0,minlength:3},email:{required:!0,email:!0,regex:/^[^!@#$%^&*]+[^\.]+@[^\.]+\.[a-zA-Z]{2,6}$/},checkbox:{required:!0},checkbox1:{required:!0},email_active:{email:!0,regex:/^[^!@#$%^&*]+[^\.]+@[^\.]+\.[a-zA-Z]{2,6}$/}},messages:{name:"",phone:"",email:"",checkbox:"",checkbox1:"",email_active:""},submitHandler:function(e){if(!$(e).find("input[name=phone]").hasClass("errorClass")){if("form_active_modal"===e.id){document.cookie="modal-active=true",formModalChoose();var a=$(e).serializeArray();requestCrmPersonData(a,e.id),requestCrmUserDataPopUp(a)}if("sendMes"===e.id){formSubmit();var t=$(e).serializeArray();requestCrmPersonData(t,e.id),requestCrmUserData(t)}if("sendMesMain"===e.id){formMain();var r=$(e).serializeArray();requestCrmPersonData(r,e.id),requestCrmUserData(r)}if("sendMesModal"===e.id){formModal();var i=$(e).serializeArray();requestCrmPersonData(i,e.id),requestCrmUserData(i)}$(".modal.modal__form").removeClass("active"),$(".modal.modal_feedback").addClass("active"),$(".js-overlay-modal").addClass("active"),$("form").trigger("reset")}}})})),jQuery.extend(jQuery.validator.messages,{required:""}),$("form.form-valid-tab").each((function(){$(this).validate({ignore:":hidden:not(:checkbox)",errorPlacement:function(e,a){a.is(":checkbox")?a.closest("label").append(e):e.insertAfter(a)},rules:{from:{required:!0},to:{required:!0},date_start:{required:!0},date_end:{required:!0},name:{required:!0},email:{required:!0,email:!0,regex:/^[^!@#$%^&*]+[^\.]+@[^\.]+\.[a-zA-Z]{2,6}$/},checkbox:{required:!0},fromMulti:{required:!0},toMulti:{required:!0},date_startMulti:{required:!0},date_endMulti:{required:!0},phone:{required:!0,minlength:3},"fromMulti[]":{required:!0},fromTest:{required:!0},toTest:{required:!0}},messages:{from:"",to:"",date_start:"",date_end:"",name:"",email:"",checkbox:"",fromMulti:"",toMulti:"",date_startMulti:"",date_endMulti:"",phone:"","fromMulti[]":""},checkForm:function(){this.prepareForm();for(var e=0,a=this.currentElements=this.elements();a[e];e++)if(null!=this.findByName(a[e].name).length&&this.findByName(a[e].name).length>1)for(var t=0;t<this.findByName(a[e].name).length;t++)this.check(this.findByName(a[e].name)[t]);else this.check(a[e]);return this.valid()},submitHandler:function(e){for(var a=$(".number_passengers-all").text(),t={},r=[],i=$(".multi-city .container-field").length,o=0;o<i;o++)t[o]={cityNameMultiAddFrom:$(".input_fromMult")[o].value||"",airportNameMultiAddFrom:$(".cityAirportMulti")[o].value||" ",cityNameMultiAddTo:$(".input_toMulti")[o].value||"",airportNameMultiAddTo:$(".cityAirportToMulti")[o].value||" ",dateAddDeparture:$(".multi-city .from")[o].value||"",dayWeekAddDeparture:document.querySelectorAll(".dayName.dayMulti")[o].textContent||""},r.push(t[o]);if("1"===e.id||"2"===e.id||"3"===e.id){var n=this.currentForm.elements,d={from:{cityName:void 0===n.from?"":n.from.value,airportName:void 0===n.cityAirport?"":n.cityAirport.value,cityNameMulti:void 0===n.fromMulti?"":n.fromMulti.value,airportNameMulti:void 0===n.cityAirportMulti?"":n.cityAirportMulti.value},to:{cityName:void 0===n.to?"":n.to.value,airportName:void 0===n.cityAirportTo?"":n.cityAirportTo.value,cityNameMulti:void 0===n.toMulti?"":n.toMulti.value,airportNameMulti:void 0===n.cityAirportToMulti?"":n.cityAirportToMulti.value},departureDate:{date:n.date_start.value,dayWeek:$(".dayName.dayNameForm1_1")[0].textContent||document.querySelectorAll(".dayName.dayMulti")[0].textContent||""},returnDate:{date:n.date_end.value||"",dayWeek:$(".dayName.dayNameForm1_2")[0].textContent||document.querySelectorAll(".dayName.dayMulti")[0].textContent||""},passenger:{type:n.type_ticket.value,allPassenger:a[0],adults:n.adults.value,children:n.children.value,infants:n.infants.value},multiAdd:r||""};localStorage.setItem("flightSearch",JSON.stringify(d)),funSearchFlight(),settingFormValues();var l=0,u=0,c=setInterval((function(){$(".loading_percentage").html(u+"%"),l++,u++,101==l&&clearInterval(c)}),50)}var s=this.currentForm.elements.type_ticket.value;if("inf_ticket_1"===e.id){var m=$("#inf_ticket_1").jqDynaForm("get");generatingRequestCrm(m,s),generatingRequestCrmPerson(m,s),formSubmitTicket(),$(".modal.modal__form").removeClass("active"),$(".modal.modal_feedback").addClass("active"),$(".js-overlay-modal").addClass("active"),$(".dayName").text(""),$("form").trigger("reset")}if("inf_ticket_2"===e.id){var f=$("#inf_ticket_2").jqDynaForm("get");generatingRequestCrm(f,s),generatingRequestCrmPerson(f,s),formSubmitTicketTwo(),$(".modal.modal__form").removeClass("active"),$(".modal.modal_feedback").addClass("active"),$(".js-overlay-modal").addClass("active"),$(".dayName").text(""),$("form").trigger("reset")}if("inf_ticket_3"===e.id){var v=$("#inf_ticket_3").jqDynaForm("get"),b=[],h=[],y=[];void 0!==v.multiCity&&v.multiCity.map((function(e){b.push(e["fromMulti[]"]),h.push(e["toMulti[]"]),y.push(e["date_startMulti[]"])})),0==y.length?(generatingRequestCrm(v,s),generatingRequestCrmPerson(v,s)):(generatingRequestCrm(v,s,b,h,y),generatingRequestCrmPerson(v,s,b,h,y)),formSubmitTicketThree(),$(".modal.modal__form").removeClass("active"),$(".modal.modal_feedback").addClass("active"),$(".js-overlay-modal").addClass("active"),$(".dayName").text(""),$("form").trigger("reset")}}})})),$("form .btn").click((function(){var e=$(this).closest("form").data("validator").settings;e.highlight=wrap($.validator.defaults.highlight,highlightDecorator),e.unhighlight=wrap($.validator.defaults.unhighlight,unhighlightDecorator)}));var reqForm,date=new Date;function requestCrmUserData(e){var a=e.find((function(e){return"name"===e.name})),t=e.find((function(e){return"phone"===e.name})),r=e.find((function(e){return"email"===e.name}));return reqForm=JSON.stringify({title:a.value+" (website)",owner_id:leadDefinition(a.value).id,"4bb2da9192ebd999d3fa40d96158960a10225267":void 0===a?"":a.value,"31559b4d1b62a55c3cd3d31fdd4749946019ebbd":void 0===t?"":t.value,"957b07223a08444eea7d2b54052850d3d3d81522":void 0===r?"":r.value})}function requestCrmUserDataPopUp(e){var a=e.find((function(e){return"name"===e.name})),t=e.find((function(e){return"email_active"===e.name})),r=a.value;return $(".modal_feedback .form_mes .mes__title").text("Thanks for the subscription!"),$(".modal_feedback .form_mes .mes__body").text("Please find confirmation email in your inbox."),reqForm=JSON.stringify({title:a.value+" (website pop up)",owner_id:13673406,b8dbcac6831d274b9a99e75395ae6f6f66892531:r,"957b07223a08444eea7d2b54052850d3d3d81522":t.value})}function sendReqSetForm(e){var a=JSON.parse(reqForm);a.person_id=e,setFormTicket(JSON.stringify(a))}function leadDefinition(e){var a=[],t=date.getDay();return"by"===countryName||"ru"===countryName||/^[а-яёА-ЯЁ\s]*$/.test(e)?(a.id=13808057,a.name="Pete"):1===t||3===t||4===t||7===t?(a.id=14033645,a.name="Derek"):(a.id=13671393,a.name="Mark"),a}function wrap(e,a){return function(){var t=Array.prototype.slice.call(arguments);return a.apply(this,t),e.apply(this,t)}}function highlightDecorator(e,a,t){$(e).closest("div .block_error").addClass(a).removeClass(t)}function unhighlightDecorator(e,a,t){$(e).closest("div .block_error").addClass(t).removeClass(a)}function closeModal(){$(".full_block .modal.modal_feedback").removeClass("active"),$(".js-overlay-modal").removeClass("active")}$(".form-valid-tab").submit((function(){var e=$(this),a=[];e.find("input[data-validate]").each((function(){a.push("input[data-validate]");for(var e=$(this).val(),t=$(this).closest(".field.block_error"),r=0;r<a.length;r++)e||(t.addClass("error"),event.preventDefault())}))}));